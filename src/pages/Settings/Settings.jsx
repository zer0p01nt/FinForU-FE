import { useEffect } from "react";
import { useHeaderStore } from "../../stores/headerStore";
import { useTranslation } from "react-i18next";
import * as S from "./SettingsStyle";
import { useNavigate } from "react-router-dom";
import api from "../../api/api";
import GoToLogin from "../../components/go-to-login/GoToLogin";
import { helmetTitle } from "../../constants/title";

export default function Settings() {
  const navigate = useNavigate();
  const { t, i18n } = useTranslation();
  const setHeaderConfig = useHeaderStore((state) => state.setHeaderConfig);
  useEffect(() => {
    setHeaderConfig({
      title: t("nav.settings"),
      showBackBtn: true, // 뒤로가기 버튼 여부
      showSettingBtn: false, // 환경설정 버튼 여부
    });
  }, [setHeaderConfig, i18n.language]);

  const handleLogout = async () => {
    try {
      await api.post("/api/members/logout");
      navigate("/", { replace: true });
    } catch {
      alert("Failed to logout.");
    }
  };

  // 로그인 상태 확인해서 비로그인 상태면 로그인 필요 컴포넌트 띄우기
  // return <GoToLogin />;
  return (
    <>
      <title>{`Settings${helmetTitle}`}</title>
      <S.Container>
        <S.Btn onClick={() => navigate("/settings/edit-information")}>
          <div>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="27"
              height="27"
              viewBox="0 0 27 27"
              fill="none"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M17.7225 0.469259L1.59768 16.5941C1.35663 16.8345 1.19857 17.1456 1.14648 17.4821L0.0184809 24.8325C-0.0195826 25.0807 0.00133377 25.3345 0.0795366 25.5731C0.15774 25.8118 0.291032 26.0287 0.468629 26.2063C0.646226 26.3839 0.863139 26.5172 1.10181 26.5954C1.34049 26.6736 1.59422 26.6945 1.84248 26.6565L9.19448 25.5285C9.53075 25.4768 9.84181 25.3193 10.0825 25.0789L26.2073 8.95406C26.5072 8.65401 26.6757 8.24712 26.6757 7.82286C26.6757 7.3986 26.5072 6.9917 26.2073 6.69166L19.9833 0.467659C19.6833 0.168194 19.2768 0 18.8529 0C18.429 0 18.0225 0.168194 17.7225 0.467659M3.51288 23.1637L4.22968 18.4853L18.8537 3.86126L22.8137 7.82286L8.18968 22.4469L3.51288 23.1637Z"
                fill="#0093DD"
              />
            </svg>
            <S.Text>{t("settings.editInfo")}</S.Text>
          </div>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="8"
            height="13"
            viewBox="0 0 8 13"
            fill="none"
          >
            <path
              d="M8.29697e-05 1.05997L1.06108 -2.86102e-05L6.84008 5.77697C6.93324 5.86954 7.00717 5.97961 7.05761 6.10086C7.10806 6.22211 7.13403 6.35214 7.13403 6.48347C7.13403 6.6148 7.10806 6.74483 7.05761 6.86608C7.00717 6.98733 6.93324 7.0974 6.84008 7.18997L1.06108 12.97L0.0010829 11.91L5.42508 6.48497L8.29697e-05 1.05997Z"
              fill="#7C7C7C"
            />
          </svg>
        </S.Btn>
        <S.Btn onClick={() => navigate("/settings/delete-account")}>
          <div>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="22"
              height="27"
              viewBox="0 0 22 27"
              fill="none"
            >
              <path
                d="M0 13.3333C0 13.687 0.140476 14.0261 0.390525 14.2761C0.640573 14.5262 0.979711 14.6667 1.33333 14.6667H11.4533L8.38667 17.72C8.26169 17.844 8.1625 17.9914 8.09481 18.1539C8.02712 18.3164 7.99227 18.4907 7.99227 18.6667C7.99227 18.8427 8.02712 19.017 8.09481 19.1794C8.1625 19.3419 8.26169 19.4894 8.38667 19.6133C8.51062 19.7383 8.65808 19.8375 8.82056 19.9052C8.98304 19.9729 9.15732 20.0077 9.33333 20.0077C9.50935 20.0077 9.68362 19.9729 9.8461 19.9052C10.0086 19.8375 10.156 19.7383 10.28 19.6133L15.6133 14.28C15.7347 14.1532 15.8299 14.0037 15.8933 13.84C16.0267 13.5154 16.0267 13.1513 15.8933 12.8267C15.8299 12.663 15.7347 12.5135 15.6133 12.3867L10.28 7.05333C10.1557 6.92902 10.0081 6.8304 9.84567 6.76312C9.68324 6.69584 9.50915 6.66121 9.33333 6.66121C9.15752 6.66121 8.98343 6.69584 8.821 6.76312C8.65857 6.8304 8.51098 6.92902 8.38667 7.05333C8.26235 7.17765 8.16373 7.32524 8.09645 7.48767C8.02917 7.6501 7.99454 7.82419 7.99454 8C7.99454 8.17581 8.02917 8.3499 8.09645 8.51233C8.16373 8.67476 8.26235 8.82235 8.38667 8.94667L11.4533 12H1.33333C0.979711 12 0.640573 12.1405 0.390525 12.3905C0.140476 12.6406 0 12.9797 0 13.3333ZM17.3333 0H4C2.93913 0 1.92172 0.421428 1.17157 1.17157C0.421427 1.92172 0 2.93913 0 4V8C0 8.35362 0.140476 8.69276 0.390525 8.94281C0.640573 9.19286 0.979711 9.33333 1.33333 9.33333C1.68696 9.33333 2.02609 9.19286 2.27614 8.94281C2.52619 8.69276 2.66667 8.35362 2.66667 8V4C2.66667 3.64638 2.80714 3.30724 3.05719 3.05719C3.30724 2.80714 3.64638 2.66667 4 2.66667H17.3333C17.687 2.66667 18.0261 2.80714 18.2761 3.05719C18.5262 3.30724 18.6667 3.64638 18.6667 4V22.6667C18.6667 23.0203 18.5262 23.3594 18.2761 23.6095C18.0261 23.8595 17.687 24 17.3333 24H4C3.64638 24 3.30724 23.8595 3.05719 23.6095C2.80714 23.3594 2.66667 23.0203 2.66667 22.6667V18.6667C2.66667 18.313 2.52619 17.9739 2.27614 17.7239C2.02609 17.4738 1.68696 17.3333 1.33333 17.3333C0.979711 17.3333 0.640573 17.4738 0.390525 17.7239C0.140476 17.9739 0 18.313 0 18.6667V22.6667C0 23.7275 0.421427 24.7449 1.17157 25.4951C1.92172 26.2452 2.93913 26.6667 4 26.6667H17.3333C18.3942 26.6667 19.4116 26.2452 20.1618 25.4951C20.9119 24.7449 21.3333 23.7275 21.3333 22.6667V4C21.3333 2.93913 20.9119 1.92172 20.1618 1.17157C19.4116 0.421428 18.3942 0 17.3333 0Z"
                fill="#0093DD"
              />
            </svg>
            <S.Text>{t("settings.deleteAccount")}</S.Text>
          </div>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="8"
            height="13"
            viewBox="0 0 8 13"
            fill="none"
          >
            <path
              d="M8.29697e-05 1.05997L1.06108 -2.86102e-05L6.84008 5.77697C6.93324 5.86954 7.00717 5.97961 7.05761 6.10086C7.10806 6.22211 7.13403 6.35214 7.13403 6.48347C7.13403 6.6148 7.10806 6.74483 7.05761 6.86608C7.00717 6.98733 6.93324 7.0974 6.84008 7.18997L1.06108 12.97L0.0010829 11.91L5.42508 6.48497L8.29697e-05 1.05997Z"
              fill="#7C7C7C"
            />
          </svg>
        </S.Btn>
        <S.LogoutBtn onClick={handleLogout}>{t("settings.logout")}</S.LogoutBtn>
      </S.Container>
    </>
  );
}
